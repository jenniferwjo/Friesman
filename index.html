<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
<title>Friesman</title>
</head>

<script id="vertex-shader" type="x-shader/x-vertex">
attribute vec4 vPosition;
attribute vec4 vNormal;

uniform mat4 mPerspective;
uniform mat4 mModelView;
uniform mat4 mObjToWorld;
uniform mat3 mNormal;	// normal matrix (inverse of M transpose)

varying vec3 N, L, E;		// these vectors will be interpolated and sent to fragment shader (for Phong shading)

attribute vec4 vTexCoord;	// texture coordinate
varying vec2 fTexCoord;		// texture coordinate to be interpolated

void
main()
{
	// fTexCoord = (vTexCoord).xy;
	vec3 pos = (mModelView * mObjToWorld * vPosition).xyz;
	vec3 light = (mModelView * vec4(10.0, 10.0, 2.0, 1.0)).xyz;

	L = normalize(light - pos);					// 	unit vector in the direction of the light source
	E = -normalize(pos);						//	normalized vector in the direction of the viewer
	N = normalize(mNormal * vNormal.xyz);	//	unit normal

	fTexCoord = vTexCoord.xy;	
    gl_Position = mPerspective * mModelView * mObjToWorld * vPosition;
}
</script>

<script id="fragment-shader" type="x-shader/x-fragment">
precision mediump float;

// id 0 : walls (blue)
// id 1 : ketchup dots (red)
// id 2 : friesman (yellow)
// id 3 : enemies (green)
uniform int objectID;

varying vec2 fTexCoord;		// interpolated texture coordinate values
uniform sampler2D texture0;	// texture 0: fire
uniform sampler2D texture1;
uniform sampler2D texture2;
uniform sampler2D texture3;

varying vec3 N, L, E;
// uniform vec4 ambientProduct, diffuseProduct, specularProduct;
// uniform float shininess;

void
main()
{
	vec4 objColor;
	if(objectID == 0)
		//objColor = vec4(0.98, 0.2667, 0.2667, 1.0);
		objColor = texture2D(texture1, fTexCoord);
	if(objectID == 1)
		objColor = vec4(0.9765, 0.6667, 0.5333, 1.0);
		//objColor = vec4(1.0, 0.0, 0.0, 1.0);
	if(objectID == 2)
		objColor = texture2D(texture3, fTexCoord);
	if(objectID == 3)
		objColor = vec4(0.0, 1.0, 0.0, 1.0);
	if(objectID == 4)
		objColor = vec4(0.6, 0.2, 0.2, 1.0);
	if(objectID == 5)
		objColor = texture2D(texture0, fTexCoord);
	if(objectID == 6)	// floor
		objColor = texture2D(texture2, fTexCoord);
	if(objectID == 7)
		objColor = vec4(0.0, 0.0, 0.0, 1.0);

	float shininess = 10.0;
	vec4 ambientProduct = objColor * vec4(0.5, 0.5, 0.5, 1.0);;
	vec4 diffuseProduct = objColor * vec4(0.5, 0.5, 0.5, 1.0);
	vec4 specularProduct = vec4(1.0, 1.0, 1.0, 1.0);
	vec4 fColor;
	vec3 H = normalize(L + E);				// halfway vector
	vec4 ambient = ambientProduct;			// ambient term
	float Kd = max(dot(L,N), 0.0);
	vec4 diffuse = Kd * diffuseProduct;		// diffuse term
	float Ks = pow(max(dot(N,H), 0.0), shininess);
	vec4 specular = Ks * specularProduct;	// specular term
	if(dot(L,N) < 0.0) {
		specular = vec4(0.0, 0.0, 0.0, 1.0);
	}

	fColor = ambient + diffuse + specular;
	fColor.a = 1.0;
	gl_FragColor = fColor;

}
</script>

<script type="text/javascript" src="util/webgl-utils.js"></script>
<script type="text/javascript" src="util/initShaders.js"></script>
<script type="text/javascript" src="util/MV.js"></script>

<script type="text/javascript" src="Game.js"></script>
<script type="text/javascript" src="Board.js"></script>
<script type="text/javascript" src="Characters.js"></script>
<script type="text/javascript" src="friesman.js"></script>
<script type="text/javascript" src="ring.js"></script>
<script type="text/javascript" src="ketchupdot.js"></script>
<script type="text/javascript" src="cube.js"></script>
<script type="text/javascript" src="torch.js"></script>
<script type="text/javascript" src="floor.js"></script>
<script type="text/javascript" src="obstacle.js"></script>

<img id="fire" src="fire2.jpeg" hidden></img>
<img id="brick" src="stonebrick.jpeg" hidden></img>
<img id="logo" src="tile.png" hidden></img>
<img id="friesman" src="friesman.jpeg" hidden></img>

<body>
<canvas id="gl-canvas" width="720" height="540">
Oops ... your browser doesn't support the HTML5 canvas element
</canvas>
</body>
</html>